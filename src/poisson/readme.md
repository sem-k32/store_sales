# Пуассоновская регрессия

Модель временного ряда - неоднородный пуассоновский процесс $\text{Po}(\sum_t^s \lambda(\tau) d\tau)$. Один сэмпл ряда представляет разность случайных реализаций процесса между концом и началом дня. Т.о. продажи $ \xi(t) $ в момент $ t $ имеют распределение $ \text{Po}(\lambda(t)) $, где $ \lambda(t) $ - произвольная неотрицательная функция, задающая параметр пуассоновского распределения в любой момент времени.

Пуассоновский процесс соответствует непрерывному во времени потоку событий, что может хорошо моделировать процесс продаж семейств товаров в розничных магазинах.  \

Временной ряд представляется в виде *pd.Dataframe*, т.к. содержит не только моменты времени, но и дополнительную информацию о ряде (e.g. количество акций по данным товарам), что может учитываться в модели.

Общий класс регрессии реализован в ```regression.py```

- вычисление правдоподобия модели на выборке из временного ряда (с точностью до аддитивной константы). Полезна для обучения модели
- вычисление $ \lambda(t) $

Различные аппроксимации $ \lambda(t) $ реализованы в ```lambda_fun.py```. Все аппроксиматоры предполагают годовую периодичность рядов

- линейные модели, основанные на полиномах/гармониках
- мультимодели с разбиением по месяцам (те же линейные модели)
- модификации линейных моделей с использванием модуля

Т.к. $ \lambda(t) \ge 0 $, аппроксиматоры должны удовлетворять этому условию. Для этого полиномиальные модели либо используют только неотрицательные коэффициенты, либо оборачиваются в модуль. Модели, основанные на гармониках, либо оборачиваются в модуль, либо используют ограниченный класс гармоник и неотрицательные коэффициенты.

Общий цикл градиентной оптимизации реализован в ```trainer.py```. Т.к. у некоторых моделей присутствуют различные ограничения на параметры, требуется реалзиация градиентных методов с проекцией на эти ограничения. Несколько проекторов реализовано в ```projector.py```.
